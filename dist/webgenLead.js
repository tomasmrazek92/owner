"use strict";(()=>{var S=(t,e)=>{$(`input[name=${t}]`).val(e)};var w=t=>{let e=localStorage.getItem(t);try{return JSON.parse(e)}catch{return e}},x=(t,e)=>{let a=typeof e=="object"?JSON.stringify(e):e;localStorage.setItem(t,a)};var b="restaurant";var k=()=>{let t=JSON.parse(localStorage.getItem(b)),e=["bar","cafe","bakery","food","restaurant"];for(let a=0;a<e.length;a++)if(t.types.includes(e[a]))return!0;return!1};function D(t){let a=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test($(t).val());return f($(t),!a,"Please fill correct email address."),a}function J(t){let e=!0;return e=U(t),e}var E=!1;function U(t){if(E)return E=!1,!0;let e=k();return e?f($(t),!1):f($(t),!0,"Are you sure this is correct? Please update your entry to a recognized restaurant."),E=!0,e}function M(t){let e,a=$(t).siblings(".select2"),r=$(t).siblings(".nice-select");a?e=a.find(".select2-selection--single"):r?e=$(r):e=$(t);let s=!0;return $(t).val()===""?(validArr.push(selectVal),$(e).addClass("is-invalid"),s=!1):$(e).removeClass("is-invalid"),s}function K(t){return f($(t),!1),!0}function Q(t){return $(t).attr("name")==="restaurant-name"&&f($(t),!0,"Please select a business location from the search results."),f($(t),!0),!1}var F=t=>{let e=t,a=!0;return $(e).prop("required")&&($(e).val()?$(e).is('[type="email"]')?a=D(e):$(e).attr("name")==="restaurant-name"?a=J(e):$(e).is("select")?a=M(e):a=K(e):a=Q(e)),a?f($(e),!1):$(e).addClass("error"),a},f=(t,e,a)=>{let r=$(t).closest(".form-field-wrapper, [field-wrapper]").find(".field-validation, [field-validation]");$(t).closest(".form-field, [form-field]").toggleClass("error",e),r.toggle(e),a&&r.text(a)};var C=(t,s,a)=>{var r=$(t),s=$(s);Object.keys(a).forEach(function(l){var c=a[l],m=r.find('input[name="'+l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")+'"]');m.length===0&&(m=r.find('select[name="'+l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")+'"]'));var h=m.val();Array.isArray(c)||(c=[c]),c.forEach(function(d){var p=s.find("input[name="+d.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")+"]");p.val(h),["phone","mobilephone","email"].includes(d)&&(p.get(0).focus(),p.get(0).blur())})})},X=t=>{let e=!1;var a=t.find("input[name=mobilephone]").parent().siblings(".hs-error-msgs").find(".hs-error-msg").text(),r=$('input[name="cellphone"]').closest("[field-wrapper]").find("[field-validation]");a?(e=!0,r.text(a),r.show()):r.hide();var s=t.find("input[name=email]").closest(".hs-fieldtype-text").find(".hs-error-msgs").find(".hs-error-msg").text(),l=$('input[name="email"]').closest("[field-wrapper]").find("[field-validation]");return s?(l.text(s),l.show(),e=!0):l.hide(),e};function R(t){A(t)}function T(){return new Promise(function(t){A=t})}var j=t=>{let e=$('[data-form="submit-btn"]'),a=e.text(),r,s=0,l=[".","..","..."],c=()=>{let p=`Submitting${l[s]}`;e.text(p),s=(s+1)%l.length},m=()=>{e.addClass("disabled")},h=()=>{e.removeClass("disabled").text(a)};m();let d=setInterval(c,500);setTimeout(()=>{r=X(t),clearInterval(d),h(),r||t.find("input[type=submit]").trigger("click")},3e3)},A;$(document).ready(()=>{let t=typeof devEnv!="undefined"&&devEnv?"https://dev-api.owner.com":"https://api.owner.com",e=!!(typeof devEnv!="undefined"&&devEnv),a=w("userId");a||(a=1111,x("userId",a));let r=$(".main-wrapper"),s=$(".growth-form"),l=$(".growth-loading"),c=$(".growth-error");function m(){$(r).add(c).add(s).stop().fadeOut(500,function(){$(l).fadeIn(400)});let o=$(".growth-loading_step"),n=0;function i(){n<o.length-1&&o.eq(n).fadeOut(1e3,function(){n+=1,o.eq(n).fadeIn(1e3),setTimeout(i,4e3)})}o.hide().eq(n).show(),setTimeout(i,4e3)}function h(){$(r).add(l).add(s).stop().hide(),$(c).stop().fadeIn()}function d(o){return w(o).place_id}let p=async o=>{let n=await fetch(`${t}/generator/v1/generations`,{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({googleId:o})});return n.ok||console.error("POST request error:",n.status,await n.text()),await n.json()},G=async o=>await(await fetch(`${t}/generator/v1/generations/${o}`)).json(),O=new Set,W=o=>{let{status:n}=o;return O.has(n)||(console.log("Checking Generation Status:",o),O.add(n)),n},q=async o=>{try{let{id:n}=await p(o);if(!n)throw new Error("Invalid ID received from POST request");return new Promise((i,v)=>{let y=setInterval(async()=>{let P=await G(n),I=W(P);if(I!=="processing"){if(clearInterval(y),I!=="success")return v(new Error(I));i(P)}},1e3)})}catch(n){let i=n.message.includes("error")||n.message.includes("cancelled")?n.message:"";return{message:n.message,status:i}}};function g(o,n,i,v){let y=n;console.log(y),v&&(y.location.errorMessage=v),typeof FS!="undefined"&&FS&&FS.event(i,FS.identify(o,y))}function N(o,n){console.log("Success:",o);let i=o.redirectUri+(e?"":"&fsUserId="+a);g(a,{location:{requestBody:n},generatedUrl:i},"Website Generation Successful"),setTimeout(()=>{window.location.href=i},250)}function L(o,n){console.log("Error:",o),h(),g(a,{location:{requestBody:n}},"Website Generation Failed",respoonse)}function z(o,n){console.log("Error:",o.message),h(),g(a,{location:{requestBody:n}},"Website Generation Failed",o.message)}async function V(o){m();try{let n=await q(o);n&&n.status==="success"?N(n,o):L(n,o)}catch(n){z(n,o)}}let u=$("#growth-form"),_,H=()=>{g(a,{displayName:u.find($("input[name=first-name]")).val()+" "+u.find($("input[name=last-name]")).val(),email:u.find($("input[name=email]")).val(),firstName:u.find($("input[name=first-name]")).val(),lastName:u.find($("input[name=last-name]")).val(),phone:u.find($("input[name=cellphone]")).val()},"Enter Contact Information Successful");let o=d(b);V(o)};$("[data-form=generateBtn]").on("click",async function(){if(!F($("input[name=restaurant-name]")))return console.log("Validation Invalid");if(e){let i=d(b);V(i);return}let n=d(b);g(a,{location:{requestBody:n}},"Website Generation Started"),$(r).fadeOut(500,function(){$(s).fadeIn(400)})}),hbspt.forms.create({portalId:"6449395",formId:"f3807262-aed3-4b9c-93a3-247ad4c55e60",target:"#hbst-form",onFormReady:R,onFormSubmitted:H}),T().then(function(o){_=$(o)});let B={name:["company","0-2/name"],international_phone_number:["phone","0-2/phone"],"restaurant-address":["address","0-2/address"],locality:["city","0-2/city"],administrative_area_level_1:["state","0-2/state"],postal_code:["zip","0-2/zip"],country:["country","0-2/country"],"first-name":"firstname","last-name":"lastname",cellphone:"mobilephone",email:"email","person-type":"lead_person_type",website:"website",place_id:"place_id",place_types:["place_types_contact","0-2/place_types"],rating:"place_rating",user_ratings_total:"user_ratings_total",hear:"how_did_you_hear_about_us",page_url:"last_pdf_download"};$("[data-form=submit-btn]").on("click",function(o){o.preventDefault();let n=!0;u.find(":input:visible, select").each(function(){let i=F($(this));n=n&&i}),n&&(S("page_url",window.location.pathname),C(u,_,B),j(_))})});})();
